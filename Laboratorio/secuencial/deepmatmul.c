#include <stdio.h>

void deepmatmul(float a[4][5], float b[5][5], float c[4][5]) {
    float h[76];  

    h[0] = a[2][1] * ( -b[1][0] - b[1][4] - b[2][0] );
    h[1] = (a[1][1] + a[1][4] - a[2][4]) * ( -b[1][4] - b[4][0] );
    h[2] = (-a[2][0] - a[3][0] + a[3][1]) * ( -b[0][0] + b[1][4] );
    h[3] = (a[0][1] + a[0][3] + a[2][3]) * ( -b[1][4] - b[3][0] );
    h[4] = (a[0][4] + a[1][1] + a[1][4]) * ( -b[1][3] + b[4][0] );
    h[5] = (-a[1][1] - a[1][4] - a[3][4]) * ( b[1][2] + b[4][0] );
    h[6] = (-a[0][0] + a[3][0] - a[3][1]) * ( b[0][0] + b[1][3] );
    h[7] = (a[2][1] - a[2][2] - a[3][2]) * ( -b[1][2] + b[2][0] );
    h[8] = (-a[0][1] - a[0][3] + a[3][3]) * ( b[1][2] + b[3][0] );
    h[9] = (a[1][1] + a[1][4]) * b[4][0];
    h[10] = (-a[1][0] - a[3][0] + a[3][1]) * ( -b[0][0] + b[1][1] );
    h[11] = (a[3][0] - a[3][1]) * b[0][0];
    h[12] = (a[0][1] + a[0][3] + a[1][3]) * ( b[1][1] + b[3][0] );
    h[13] = (a[0][2] - a[2][1] + a[2][2]) * ( b[1][3] + b[2][0] );
    h[14] = (-a[0][1] - a[0][3]) * b[3][0];
    h[15] = (-a[2][1] + a[2][2]) * b[2][0];
    h[16] = (a[0][1] + a[0][3] - a[1][0] + a[1][1] - a[1][2] + a[1][3] - a[2][1] + a[2][2] - a[3][0] + a[3][1]) * b[1][1];
    h[17] = a[1][0] * ( b[0][0] + b[0][1] + b[4][1] );
    h[18] = -a[1][2] * ( b[2][0] + b[2][1] + b[4][1] );
    h[19] = (-a[0][4] + a[1][0] + a[1][2] - a[1][4]) * ( -b[0][0] - b[0][1] + b[0][3] - b[4][1] );
    h[20] = (a[1][0] + a[1][2] - a[1][4]) * b[4][1];
    h[21] = (a[0][2] - a[0][3] - a[1][3]) * ( b[0][0] + b[0][1] - b[0][3] - b[2][0] - b[2][1] + b[2][3] + b[3][3] );
    h[22] = a[0][2] * ( -b[2][0] + b[2][3] + b[3][3] );
    h[23] = a[0][4] * ( -b[3][3] - b[4][0] + b[4][3] );
    h[24] = -a[0][0] * ( b[0][0] - b[0][3] );
    h[25] = (-a[0][2] + a[0][3] + a[0][4]) * b[3][3];
    h[26] = (a[0][2] - a[2][0] + a[2][2]) * ( b[0][0] - b[0][3] + b[0][4] + b[2][4] );
    h[27] = -a[2][3] * ( -b[2][4] - b[3][0] - b[3][4] );
    h[28] = a[2][0] * ( b[0][0] + b[0][4] + b[2][4] );
    h[29] = (a[2][0] - a[2][2] + a[2][3]) * b[2][4];
    h[30] = (-a[0][3] - a[0][4] - a[2][3]) * ( -b[3][3] - b[4][0] + b[4][3] - b[4][4] );
    h[31] = (a[1][0] + a[3][0] + a[3][3]) * ( b[0][2] - b[3][0] - b[3][1] - b[3][2] );
    h[32] = a[3][2] * ( -b[2][0] - b[2][2] );
    h[33] = a[3][3] * ( -b[0][2] + b[3][0] + b[3][2] );
    h[34] = -a[3][4] * ( b[0][2] + b[4][0] + b[4][2] );
    h[35] = (a[1][2] - a[1][4] - a[3][4]) * ( b[2][0] + b[2][1] + b[2][2] + b[4][1] );
    h[36] = (-a[3][0] - a[3][3] + a[3][4]) * b[0][2];
    h[37] = (-a[1][2] - a[2][0] + a[2][2] - a[2][3]) * ( b[2][4] + b[3][0] + b[3][1] + b[3][4] );
    h[38] = (-a[2][0] - a[3][0] - a[3][3] + a[3][4]) * ( b[0][2] + b[4][0] + b[4][2] + b[4][4] );
    h[39] = (-a[0][2] + a[0][3] + a[0][4] - a[3][3]) * ( -b[2][0] - b[2][2] + b[2][3] + b[3][3] );
    h[40] = (-a[0][0] + a[3][0] - a[3][4]) * ( b[0][2] + b[2][0] + b[2][2] - b[2][3] + b[4][0] + b[4][2] - b[4][3] );
    h[41] = (-a[1][0] + a[1][4] - a[2][4]) * ( -b[0][0] - b[0][1] - b[0][4] + b[3][0] + b[3][1] + b[3][4] - b[4][1] );
    h[42] = a[1][3] * ( b[3][0] + b[3][1] );
    h[43] = (a[1][2] + a[2][1] - a[2][2]) * ( b[1][1] - b[2][0] );
    h[44] = (-a[2][2] + a[2][3] - a[3][2]) * ( b[2][4] + b[3][0] + b[3][2] + b[3][4] + b[4][0] + b[4][2] + b[4][4] );
    h[45] = -a[2][4] * ( -b[4][0] - b[4][4] );
    h[46] = (a[1][0] - a[1][4] - a[2][0] + a[2][4]) * ( b[0][0] + b[0][1] + b[0][4] - b[3][0] - b[3][1] - b[3][4] );
    h[47] = (-a[1][2] + a[2][2]) * ( b[1][1] + b[2][1] + b[2][4] + b[3][0] + b[3][1] + b[3][4] );
    h[48] = (-a[0][0] - a[0][2] + a[0][3] + a[0][4] - a[1][0] - a[1][2] + a[1][3] + a[1][4]) * ( -b[0][0] - b[0][1] + b[0][3] );
    h[49] = (-a[0][3] - a[1][3]) * ( b[1][1] - b[2][0] - b[2][1] + b[2][3] - b[3][1] + b[3][3] );
    h[50] = a[1][1] * ( b[1][0] + b[1][1] - b[4][0] );
    h[51] = a[3][1] * (b[0][0] + b[1][0] + b[1][2]);
    h[52] = -a[0][1] * (-b[1][0] + b[1][3] + b[3][0]);
    h[53] = (a[0][1] + a[0][3] - a[1][1] - a[1][4] - a[2][1] + a[2][2] - a[3][1] + a[3][2] - a[3][3] - a[3][4]) * b[1][2];
    h[54] = (a[0][3] - a[3][3]) * (-b[1][2] + b[2][0] + b[2][2] - b[2][3] + b[3][2] - b[3][3]);
    h[55] = (a[0][0] - a[0][4] - a[3][0] + a[3][4]) * (b[2][0] + b[2][2] - b[2][3] + b[4][0] + b[4][2] - b[4][3]);
    h[56] = (-a[2][0] - a[3][0]) * (-b[0][2] - b[0][4] - b[1][4] - b[4][0] - b[4][2] - b[4][4]);
    h[57] = (-a[0][3] - a[0][4] - a[2][3] - a[2][4]) * (-b[4][0] + b[4][3] - b[4][4]);
    h[58] = (-a[2][2] + a[2][3] - a[3][2] + a[3][3]) * (b[3][0] + b[3][2] + b[3][4] + b[4][0] + b[4][2] + b[4][4]);
    h[59] = (a[1][4] + a[3][4]) * (b[1][2] - b[2][0] - b[2][1] - b[2][2] - b[4][1] - b[4][2]);
    h[60] = (a[0][3] + a[2][3]) * (b[0][0] - b[0][3] + b[0][4] - b[1][4] - b[3][3] + b[3][4] - b[4][0] + b[4][3] - b[4][4]);
    h[61] = (a[1][0] + a[3][0]) * (b[0][1] + b[0][2] + b[1][1] - b[3][0] - b[3][1] - b[3][2]);
    h[62] = (-a[2][2] - a[3][2]) * (-b[1][2] - b[2][2] - b[2][4] - b[3][0] - b[3][2] - b[3][4]);
    h[63] = (a[0][0] - a[0][2] - a[0][3] + a[2][0] - a[2][2] - a[2][3]) * (b[0][0] - b[0][3] + b[0][4]);
    h[64] = (-a[0][0] + a[3][0]) * (-b[0][2] + b[0][3] + b[1][3] - b[4][0] - b[4][2] + b[4][3]);
    h[65] = (a[0][0] - a[0][1] + a[0][2] - a[0][4] - a[1][1] - a[1][4] - a[2][1] + a[2][2] - a[3][0] + a[3][1]) * b[1][3];
    h[66] = (a[1][4] - a[2][4]) * (b[0][0] + b[0][1] + b[0][4] - b[1][4] - b[3][0] - b[3][1] - b[3][4] + b[4][1] + b[4][4]);
    h[67] = (a[0][0] + a[0][2] - a[0][3] - a[0][4] - a[3][0] - a[3][2] + a[3][3] + a[3][4]) * (-b[2][0] - b[2][2] + b[2][3]);
    h[68] = (-a[0][2] + a[0][3] - a[1][2] + a[1][3]) * (-b[1][3] - b[2][0] - b[2][1] + b[2][3] - b[4][1] + b[4][3]);
    h[69] = (a[1][2] - a[1][4] + a[3][2] - a[3][4]) * (-b[2][0] - b[2][1] - b[2][2]);
    h[70] = (-a[2][0] + a[2][2] - a[2][3] + a[2][4] - a[3][0] + a[3][2] - a[3][3] + a[3][4]) * (-b[4][0] - b[4][2] - b[4][4]);
    h[71] = (-a[1][0] - a[1][3] - a[3][0] - a[3][3]) * (b[3][0] + b[3][1] + b[3][2]);
    h[72] = (a[0][2] - a[0][3] - a[0][4] + a[1][2] - a[1][3] - a[1][4]) * (b[0][0] + b[0][1] - b[0][3] + b[1][3] + b[4][1] - b[4][3]);
    h[73] = (a[1][0] - a[1][2] + a[1][3] - a[2][0] + a[2][2] - a[2][3]) * (b[3][0] + b[3][1] + b[3][4]);
    h[74] = - (a[0][1] + a[0][3] - a[1][1] - a[1][4] - a[2][0] + a[2][1] + a[2][3] + a[2][4] - a[3][0] + a[3][1]) * b[1][4];
    h[75] = (a[0][2] + a[2][2]) * (-b[0][0] + b[0][3] - b[0][4] + b[1][3] + b[2][3] - b[2][4]);

    c[0][0] = -h[9] + h[11] + h[13] - h[14] - h[15] + h[52] + h[4] - h[65] - h[6];
    c[0][1] = h[12] + h[14] + h[19] + h[20] - h[21] + h[22] + h[24] - h[42] + h[48] + h[49];
    c[0][2] = h[14] + h[22] + h[23] + h[33] - h[36] + h[39] - h[40] + h[54] - h[55] - h[8];
    c[0][3] = -h[9] + h[11] + h[13] - h[15] + h[22] + h[23] + h[24] + h[25] + h[4] - h[65] - h[6];
    c[0][4] = h[14] + h[23] + h[24] + h[26] - h[27] + h[29] + h[30] - h[3] + h[60] + h[63];
    c[1][0] = h[9] + h[10] - h[11] + h[12] + h[14] + h[15] - h[16] - h[43] + h[50];
    c[1][1] = -h[10] + h[11] - h[12] - h[14] - h[15] + h[16] + h[17] - h[18] - h[20] + h[42] + h[43];
    c[1][2] = -h[9] + h[18] + h[31] + h[34] + h[35] + h[36] - h[42] - h[59] - h[5] - h[71];
    c[1][3] = h[9] + h[17] - h[18] + h[19] - h[21] - h[23] - h[25] - h[4] - h[68] + h[72];
    c[1][4] = -h[9] - h[17] - h[1] - h[29] - h[37] + h[41] - h[42] + h[45] + h[66] + h[73];
    c[2][0] = h[9] - h[11] + h[14] + h[15] - h[0] + h[1] + h[2] - h[3] + h[74];
    c[2][1] = -h[15] - h[18] - h[20] - h[27] - h[28] - h[37] + h[41] + h[43] - h[46] + h[47];
    c[2][2] = -h[15] - h[27] + h[32] + h[36] - h[38] + h[44] - h[45] + h[62] - h[70] - h[7];
    c[2][3] = -h[13] + h[15] - h[22] - h[25] + h[26] + h[28] + h[30] + h[45] - h[57] + h[75];
    c[2][4] = -h[9] + h[11] - h[14] + h[27] + h[28] - h[1] - h[29] - h[2] + h[45] + h[3] - h[74];
    c[3][0] = -h[9] + h[11] - h[14] - h[15] + h[51] + h[53] - h[5] - h[7] + h[8];
    c[3][1] = h[10] - h[11] - h[17] + h[20] - h[31] + h[32] - h[33] - h[35] + h[61] - h[69];
    c[3][2] = h[9] + h[14] + h[15] - h[32] + h[33] - h[34] - h[36] - h[53] + h[5] + h[7] - h[8];
    c[3][3] = h[11] + h[24] + h[25] - h[32] - h[34] - h[39] + h[40] + h[64] - h[67] - h[6];
    c[3][4] = -h[11] - h[28] + h[29] - h[33] + h[34] + h[38] + h[2] - h[44] + h[56] + h[58];
}

void deepmatmul3(float a[20], float b[25], float c[20], int hA_mas[76][6], int hA_menos[76][6], int hB_mas[76][7], int hB_menos[76][6], int hC_mas[20][8], int hC_menos[20][8]) {                                                                        

    float h[76];  
    float h2[76];  


    for (int i = 0; i < 76; ++i)
    {
        h[i]=0;
        h2[i]=(i==44)?b[hB_mas[44][6]]:0;

        for (int j = 0; j < 6; ++j)
        {
            h[i] +=(hA_mas[i][j]  >=0)?a[hA_mas[i][j]]  :0;
            h[i] -=(hA_menos[i][j]>=0)?a[hA_menos[i][j]]:0;

            h2[i]+=(hB_mas[i][j]  >=0)?b[hB_mas[i][j]]  :0;
            h2[i]-=(hB_menos[i][j]>=0)?b[hB_menos[i][j]]:0;
        }

        h[i]*=h2[i];
    }

    for (int i = 0; i < 20; ++i){
        
        c[i]=0;

        for (int j = 0; j < 8; ++j)
        {
            c[i]+=(hC_mas[i][j]  >=0)?h[hC_mas[i][j]]  :0;
            c[i]-=(hC_menos[i][j]>=0)?h[hC_menos[i][j]]:0;
        }
    }                                                                             
}                                                                                               





